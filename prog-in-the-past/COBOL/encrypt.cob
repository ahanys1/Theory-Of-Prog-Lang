       IDENTIFICATION DIVISION.
       PROGRAM-ID. encrypt.

       DATA DIVISION.
       WORKING-STORAGE SECTION.
           01 INPUT-STRING PIC X(100) VALUE "Hello, World!".
           01 SHIFT-VALUE PIC 9 VALUE 3.
           01 ENCRYPTED-STRING PIC X(100).

       PROCEDURE DIVISION.
           DISPLAY "Original string: " INPUT-STRING
           DISPLAY "Shift value: " SHIFT-VALUE

           MOVE INPUT-STRING TO ENCRYPTED-STRING
           PERFORM ENCRYPT-STRING
           DISPLAY "Encrypted string: " ENCRYPTED-STRING

           STOP RUN.

       ENCRYPT-STRING.
           01 CHAR-INDEX PIC 9.
           01 CHAR-CODE PIC 9.
           01 SHIFTED-CHAR-CODE PIC 9.

           PERFORM VARYING CHAR-INDEX FROM 1 BY 1 UNTIL CHAR-INDEX > LENGTH OF INPUT-STRING
               MOVE CHARACTERS (CHAR-INDEX:1) OF ENCRYPTED-STRING TO CHAR-CODE
               IF CHAR-CODE >= 65 AND CHAR-CODE <= 90
                   COMPUTE SHIFTED-CHAR-CODE = ((CHAR-CODE - 65 + SHIFT-VALUE) MOD 26) + 65
                   MOVE SHIFTED-CHAR-CODE TO CHARACTERS (CHAR-INDEX:1) OF ENCRYPTED-STRING
               ELSE
                   IF CHAR-CODE >= 97 AND CHAR-CODE <= 122
                       COMPUTE SHIFTED-CHAR-CODE = ((CHAR-CODE - 97 + SHIFT-VALUE) MOD 26) + 97
                       MOVE SHIFTED-CHAR-CODE TO CHARACTERS (CHAR-INDEX:1) OF ENCRYPTED-STRING
                   END-IF
               END-IF
       END-PERFORM.
